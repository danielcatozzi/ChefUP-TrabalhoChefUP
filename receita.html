<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Detalhes da Receita</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link id="theme-style" rel="stylesheet" href="css/styles.css">
  <link rel="icon" href="logo.png" type="image/png">
  <script src="js/theme.js" defer></script>
</head>
<body>
<header class="topbar">
  <div class="container bar">
    <a class="logo" href="index.html">
        <img src="logo.png" alt="Portal Gourmet" style="width: 50px; height: 50px; border-radius: 8px;">
        Portal Gourmet
    </a>
    
    <div class="top-actions">
        <a href="javascript:history.back()" class="btn">voltar</a>
    </div>
  </div>
</header>

<main class="container" style="margin-top: 30px;">
  
  <div id="conteudo-receita" class="form-card" style="max-width: 800px; display: none;">
    
    <div style="position: relative;">
        <img id="img-receita" src="" alt="" style="width: 100%; height: 400px; object-fit: cover; border-radius: 12px;">
        <span id="tipo-receita" class="time-badge" style="top: 20px; right: 20px; font-size: 1.2em; padding: 8px 15px;">Tipo</span>
    </div>

    <h1 id="nome-receita" style="margin-top: 25px; font-size: 2.5em; color: var(--accent);">Nome da Receita</h1>
    <p class="kicker" style="font-size: 1.2em;">â± Tempo de preparo: <strong id="tempo-receita">0 min</strong></p>

    <hr style="border: 0; border-top: 1px solid #ddd; margin: 30px 0;">

    <h3>ğŸ“ Ingredientes</h3>
    <div id="ingredientes-receita" style="line-height: 1.8; font-size: 1.1em; color: var(--text); background: var(--bg); padding: 20px; border-radius: 10px;"></div>

    <h3 style="margin-top: 30px;">ğŸ³ Modo de Preparo</h3>
    <div id="preparo-receita" style="line-height: 1.8; font-size: 1.1em; color: var(--text);"></div>

  </div>
  
  <div id="loading" class="center" style="margin-top: 50px; font-size: 1.5em; color: var(--muted);">
      Carregando delÃ­cias...
  </div>

</main>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Pega o ID que estÃ¡ na URL
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');

        if(!id) {
            // Este caso jÃ¡ foi corrigido anteriormente
            document.getElementById('loading').textContent = 'Erro: ID da receita nÃ£o fornecido.';
            return;
        }

        // 2. Busca no PHP
        fetch(`php/buscar_receita.php?id=${id}`)
            .then(r => r.json())
            .then(data => {
                if(data.success) {
                    const r = data.receita;
                    
                    // 3. Preenche os campos
                    document.getElementById('img-receita').src = r.imagem;
                    document.getElementById('nome-receita').textContent = r.nome;
                    document.getElementById('tipo-receita').textContent = r.tipo;
                    document.getElementById('tempo-receita').textContent = r.tempo;
                    document.getElementById('ingredientes-receita').innerHTML = r.ingredientes;
                    document.getElementById('preparo-receita').innerHTML = r.preparo;

                    // Mostra a receita
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('conteudo-receita').style.display = 'block';
                } else {
                    document.getElementById('loading').textContent = 'Receita nÃ£o encontrada no banco :(';
                }
            })
            .catch(err => {
                console.error('Erro de rede:', err);
                document.getElementById('loading').textContent = 'Erro de rede ao carregar receita.';
            });
    });
</script>

</body>
</html>